---
title: å¦‚ä½•ä¿®æ”¹å½“å‰ç”¨æˆ·çš„ç”¨æˆ·å in Linux
date: 2025-12-22 15:01:00 +0800
author: CAFEBABY
categories: [Linux]
tags: [Linux]
pin: false
math: true
mermaid: false
---

# åœ¨ Linux ä¸­å®Œæ•´é‡å‘½åç”¨æˆ·ï¼šç”¨æˆ·åã€å®¶ç›®å½•ã€ç”¨æˆ·ç»„ä¸ UID è¯¦è§£

åœ¨ Linux ç³»ç»Ÿç®¡ç†ä¸­ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å› ä¸ºç»„ç»‡è°ƒæ•´ã€å®‰å…¨ç­–ç•¥æˆ–ä¸ªäººåå¥½ç­‰åŸå› ï¼Œå¯¹ç°æœ‰ç”¨æˆ·è¿›è¡Œé‡å‘½åã€‚ä½†ä»…ä¿®æ”¹ç”¨æˆ·åæ˜¯ä¸å¤Ÿçš„â€”â€”ä¸ºäº†ä¿æŒç³»ç»Ÿä¸€è‡´æ€§ï¼Œé€šå¸¸è¿˜éœ€è¦åŒæ­¥æ›´æ–°å…¶**ç”¨æˆ·ç»„å**ã€**å®¶ç›®å½•è·¯å¾„**ä»¥åŠ**ç”¨æˆ· IDï¼ˆUIDï¼‰**ã€‚

æœ¬æ–‡å°†åŸºäº `usermod` å’Œ `groupmod` ç­‰æ ‡å‡†å‘½ä»¤ï¼Œç³»ç»Ÿæ€§åœ°ä»‹ç»å¦‚ä½•å®‰å…¨ã€å®Œæ•´åœ°å®Œæˆä¸€æ¬¡ç”¨æˆ·é‡å‘½åæ“ä½œã€‚

> âš ï¸ **é‡è¦å‰æ**ï¼šæ“ä½œå‰å¿…é¡»ç¡®ä¿ç›®æ ‡ç”¨æˆ·**å·²å®Œå…¨ç™»å‡º**ï¼Œä¸”**æ— ä»»ä½•è¿è¡Œä¸­çš„è¿›ç¨‹**ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ `usermod: user xxx is currently logged in` é”™è¯¯ã€‚

---

## 1. ç»ˆæ­¢ç”¨æˆ·æ‰€æœ‰è¿›ç¨‹

åœ¨æ‰§è¡Œä»»ä½•ä¿®æ”¹å‰ï¼Œè¯·å…ˆåˆ‡æ¢åˆ° root æˆ–å…·æœ‰ sudo æƒé™çš„è´¦æˆ·ï¼Œå¹¶ç»ˆæ­¢ç›®æ ‡ç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ï¼š

```bash
sudo pkill -u æ—§ç”¨æˆ·å
sudo pkill -9 -u æ—§ç”¨æˆ·å  # å¼ºåˆ¶ç»ˆæ­¢
```

ä¾‹å¦‚ï¼Œè‹¥æ—§ç”¨æˆ·åä¸º `dan`ï¼š

```bash
sudo pkill -u dan
sudo pkill -9 -u dan
```

---

## 2. ä¿®æ”¹ç”¨æˆ·å

ä½¿ç”¨ `usermod -l` å‘½ä»¤æ›´æ”¹ç™»å½•åï¼š

```bash
sudo usermod -l æ–°ç”¨æˆ·å æ—§ç”¨æˆ·å
```

âœ… è¯¥æ“ä½œä¼šæ›´æ–° `/etc/passwd` å’Œ `/etc/shadow` ä¸­çš„ç”¨æˆ·åå­—æ®µï¼Œä½†**ä¸ä¼š**è‡ªåŠ¨ä¿®æ”¹å®¶ç›®å½•ã€ç”¨æˆ·ç»„æˆ– UIDã€‚

ç¤ºä¾‹ï¼š

```bash
sudo usermod -l susan dan
```

---

## 3. ä¿®æ”¹å®¶ç›®å½•ï¼ˆå«è¿ç§»ï¼‰

è‹¥å¸Œæœ›å°†å®¶ç›®å½•ä» `/home/æ—§ç”¨æˆ·å` è¿ç§»åˆ° `/home/æ–°ç”¨æˆ·å`ï¼Œä½¿ç”¨ `-d` å’Œ `-m` é€‰é¡¹ï¼š

```bash
sudo usermod -d /home/æ–°ç”¨æˆ·å -m æ–°ç”¨æˆ·å
```

- `-d`ï¼šæŒ‡å®šæ–°çš„å®¶ç›®å½•è·¯å¾„  
- `-m`ï¼šè‡ªåŠ¨å°†æ—§ç›®å½•å†…å®¹**ç§»åŠ¨**åˆ°æ–°è·¯å¾„

ç¤ºä¾‹ï¼š

```bash
sudo usermod -d /home/susan -m susan
```

> ğŸ” æ­¤æ“ä½œä¼šæ›´æ–° `/etc/passwd` ä¸­çš„ home å­—æ®µï¼Œå¹¶ç‰©ç†ç§»åŠ¨ç›®å½•ã€‚

---

## 4. ä¿®æ”¹ç”¨æˆ·ç»„å

Linux é»˜è®¤ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºåŒåç§æœ‰ç»„ã€‚é‡å‘½åç”¨æˆ·åï¼Œå»ºè®®åŒæ­¥ä¿®æ”¹ç»„åä»¥ä¿æŒä¸€è‡´ï¼š

```bash
sudo groupmod -n æ–°ç”¨æˆ·å æ—§ç”¨æˆ·å
```

ç¤ºä¾‹ï¼š

```bash
sudo groupmod -n susan dan
```

> ğŸ’¡ è¯¥å‘½ä»¤ä¿®æ”¹ `/etc/group` å’Œ `/etc/gshadow` ä¸­çš„ç»„åï¼Œä½†**ç»„ IDï¼ˆGIDï¼‰ä¿æŒä¸å˜**ã€‚

---

## 5. ï¼ˆå¯é€‰ï¼‰ä¿®æ”¹ç”¨æˆ· UID

å¦‚éœ€æ›´æ”¹ç”¨æˆ·çš„ UIDï¼ˆä¾‹å¦‚ç»Ÿä¸€è§„åˆ’ ID èŒƒå›´ï¼‰ï¼Œå¯æ‰§è¡Œï¼š

```bash
sudo usermod -u æ–°UID æ–°ç”¨æˆ·å
```

ç¤ºä¾‹ï¼š

```bash
sudo usermod -u 2000 susan
```

> âš ï¸ ä¿®æ”¹ UID åï¼ŒåŸç”¨æˆ·æ‹¥æœ‰çš„**æ‰€æœ‰æ–‡ä»¶**çš„å±ä¸»ä»ä¸ºæ—§ UIDã€‚è‹¥éœ€åŒæ­¥æ›´æ–°æ–‡ä»¶å±ä¸»ï¼Œéœ€é¢å¤–æ‰§è¡Œï¼š
>
> ```bash
> sudo find / -user æ—§UID -exec chown -h æ–°ç”¨æˆ·å {} \;
> ```
> ï¼ˆè°¨æ…æ“ä½œï¼Œå»ºè®®å…ˆåœ¨ç‰¹å®šç›®å½•å¦‚ `/home` ä¸‹æµ‹è¯•ï¼‰

---

## 6. éªŒè¯ä¿®æ”¹ç»“æœ

ä½¿ç”¨ `id` å‘½ä»¤æ£€æŸ¥æ–°ç”¨æˆ·ä¿¡æ¯æ˜¯å¦ä¸€è‡´ï¼š

```bash
id æ–°ç”¨æˆ·å
```

è¾“å‡ºåº”ç±»ä¼¼ï¼š

```bash
uid=2000(susan) gid=2000(susan) groups=2000(susan),...
```

åŒæ—¶å¯æ£€æŸ¥å®¶ç›®å½•æ˜¯å¦å­˜åœ¨ã€æƒé™æ˜¯å¦æ­£ç¡®ï¼š

```bash
ls -ld /home/æ–°ç”¨æˆ·å
```

---

## æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ

- **ä¸è¦åœ¨å½“å‰ç”¨æˆ·ä¸‹æ‰§è¡Œé‡å‘½å**ï¼šå¿…é¡»ä»å…¶ä»–è´¦æˆ·ï¼ˆå¦‚ rootï¼‰æ“ä½œã€‚
- **å¤‡ä»½é‡è¦æ•°æ®**ï¼šé‡å‘½åæ¶‰åŠæ–‡ä»¶ç³»ç»Ÿå’Œæƒé™å˜æ›´ï¼Œæ“ä½œå‰å»ºè®®å¤‡ä»½ `/home/æ—§ç”¨æˆ·å`ã€‚
- **æ£€æŸ¥æœåŠ¡ä¾èµ–**ï¼šæŸäº›æœåŠ¡ï¼ˆå¦‚ cronã€systemd ç”¨æˆ·æœåŠ¡ã€SSH authorized_keysï¼‰å¯èƒ½ç¡¬ç¼–ç æ—§ç”¨æˆ·åï¼Œéœ€æ‰‹åŠ¨æ›´æ–°ã€‚
- **è™šæ‹Ÿæœºï¼ˆVMï¼‰ä¸­æ“ä½œç›¸åŒ**ï¼šåªè¦æ‹¥æœ‰ root æƒé™ï¼Œæ­¥éª¤å®Œå…¨ä¸€è‡´ã€‚

---

## æ€»ç»“

å®Œæ•´çš„ Linux ç”¨æˆ·é‡å‘½åæµç¨‹å¦‚ä¸‹ï¼š

```bash
# 1. ç»ˆæ­¢è¿›ç¨‹
sudo pkill -u dan
sudo pkill -9 -u dan

# 2. æ”¹ç”¨æˆ·å
sudo usermod -l susan dan

# 3. æ”¹å®¶ç›®å½•
sudo usermod -d /home/susan -m susan

# 4. æ”¹ç”¨æˆ·ç»„å
sudo groupmod -n susan dan

# 5. ï¼ˆå¯é€‰ï¼‰æ”¹ UID
sudo usermod -u 2000 susan

# 6. éªŒè¯
id susan
```

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå³å¯å®‰å…¨ã€å½»åº•åœ°å®Œæˆ Linux ç”¨æˆ·é‡å‘½åï¼Œç¡®ä¿ç³»ç»Ÿé…ç½®ä¸ç”¨æˆ·ç¯å¢ƒçš„ä¸€è‡´æ€§ã€‚

---

> å‚è€ƒèµ„æ–™ï¼š  
> - [CSDN: Linuxå°†ç”¨æˆ·åä¿®æ”¹åï¼Œè¿˜éœ€è¦ä¿®æ”¹ç»„å+å®¶ç›®å½•+UID](https://blog.csdn.net/nicolewjt/article/details/85273300)  
> - [Linuxä¸­å›½: Linux ä¸‹å¦‚ä½•ä¿®æ”¹ç”¨æˆ·å](https://linux.cn/article-9192-1.html)  
> - [CSDN: Linux ä¿®æ”¹ç”¨æˆ·åï¼ˆåŒæ—¶ä¿®æ”¹ç”¨æˆ·ç»„åå’Œå®¶ç›®å½•ï¼‰](https://blog.csdn.net/qq_41917908/article/details/89001252)